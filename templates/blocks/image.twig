{% from '@templates/macros/lib.twig' import img %}

{% set image = block.image.toFile %}

{% if image %}

    {% set caption = block.caption %}
    {% set ratio = block.ratio.toString ?? '' %}

    {% set width = width ?? 2000 %}
    {% set sizes = sizes ?? '' %}

    <figure>
        {{ img(image, {
            transform: {width, ratio},
            attr: {
                class: 'object-cover h-full w-full',
                loading: 'lazy',
                sizes: sizes
            },
            mode: block.crop.isTrue ? 'crop' : 'resize'
        } ) }}
        {% if caption.isNotEmpty %}
            <figcaption>
                {{ caption }}
            </figcaption>
        {% endif %}
    </figure>
{% endif %}

